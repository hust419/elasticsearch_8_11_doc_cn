
已在7.16中废弃。

_使用Elasticsearch监控插件来收集和传输监控数据已经被弃用。强烈建议使用Elastic Agent和Metricbeat来收集和传输监控数据到监控集群。如果您之前配置了传统的收集方法，应迁移到使用Elastic Agent或Metricbeat收集方法。_

默认情况下，Elasticsearch监控功能已启用，但数据收集已禁用。要启用数据收集，请使用xpack.monitoring.collection.enabled设置。

除非另有说明，这些设置可以使用cluster-update-settings API在活动集群上动态更新。

要调整监控数据在监控UI中的显示方式，请在kibana.yml中配置xpack.monitoring设置。要控制从Logstash收集监控数据的方式，请在logstash.yml中配置监控设置。

有关更多信息，请参阅监控集群。

##### 通用监控设置
xpack.monitoring.enabled
[7.8.0] 已在7.8.0版本中弃用。基本许可证功能应始终启用（静态）。此废弃设置无效。

##### 监控集合设置
xpack.monitoring.collection.settings 控制从Elasticsearch节点收集数据的方式。

xpack.monitoring.collection.enabled
（动态）[7.16.0] 已在7.16.0版本中废弃。设置为true以启用监控数据的收集。当此设置为false（默认值）时，不会收集Elasticsearch监控数据，且来自其他来源（如Kibana、Beats和Logstash等）的所有监控数据都将被忽略。

xpack.monitoring.collection.interval logo cloud
[6.3.0] 已在6.3.0版本中废弃。改用xpack.monitoring.collection.enabled设置为false（动态）。不再支持将数据收集间隔设置为-1，从7.0.0版本开始。

控制收集数据样本的收集频率。默认为10秒。如果修改了收集间隔，请在kibana.yml中设置xpack.monitoring.min_interval_seconds选项为相同的值。

xpack.monitoring.elasticsearch.collection.enabled
（动态）[7.16.0] 已在7.16.0版本中废弃。控制是否应收集有关Elasticsearch集群的统计信息。默认为true。这与xpack.monitoring.collection.enabled不同，后者允许您启用或禁用所有监控集合。然而，此设置仅禁用Elasticsearch数据的收集，同时仍允许其他数据（例如Kibana、Logstash、Beats或APM Server监控数据）通过此集群。

xpack.monitoring.collection.cluster.stats.timeout
（动态）[7.16.0] 已在7.16.0版本中废弃。用于收集集群统计信息的超时时间，以时间单位表示。默认为10秒。

xpack.monitoring.collection.node.stats.timeout
（动态）[7.16.0] 已在7.16.0版本中废弃。用于收集节点统计信息的超时时间，以时间单位表示。默认为10秒。

xpack.monitoring.collection.indices
（动态）[7.16.0] 已在7.16.0版本中废弃。控制监控功能从哪些索引收集数据。默认为所有索引。将索引名称指定为逗号分隔的列表，例如test1，test2，test3。名称可以包含通配符，例如test*。可以通过在索引名称前加上-来明确排除索引。例如test*，-test3将监视以test开头的所有索引，但不包括test3。系统索引（如.security*或.kibana*）始终以.开头，通常应进行监视。考虑将.*添加到索引列表以确保监视系统索引。例如：.*，test*，-test3

xpack.monitoring.collection.index.stats.timeout
（动态）[7.16.0] 已在7.16.0版本中废弃。用于收集索引统计信息的超时时间，以时间单位表示。默认为10秒。

xpack.monitoring.collection.index.recovery.active_only
（动态）[7.16.0] 已在7.16.0版本中废弃。控制是否收集所有恢复。设置为true以仅收集活动恢复。默认为false。

xpack.monitoring.collection.index.recovery.timeout
（动态）[7.16.0] 已在7.16.0版本中废弃。用于收集恢复信息的超时时间，以时间单位表示。默认为10秒。

xpack.monitoring.history.duration logo cloud
（动态）[7.16.0] 已在7.16.0版本中废弃。超出此监控导出器创建的索引自动删除的保留持续时间，以时间单位表示。默认为7天。

此设置的最小值为1天，以确保有东西被监控，并且无法禁用。

此设置目前仅影响本地类型的导出器。使用http导出器创建的索引不会自动删除。

xpack.monitoring.exporters
（静态）配置代理存储监控数据的位置。默认情况下，代理使用本地导出器，在安装它的集群上索引监控数据。使用HTTP导出器将数据发送

到单独的监控集群。有关更多信息，请参阅本地导出器设置、HTTP导出器设置和工作原理。

##### 本地导出器设置
本地导出器是监控功能使用的默认导出器。正如其名称所暗示，它将数据导出到本地集群，因此几乎不需要进行配置。

如果您不提供任何导出器，则监控功能会自动为您创建一个。如果提供了任何导出器，则不会添加默认导出器。

xpack.monitoring.exporters.my_local:
  type: local
type
[7.16.0] 已在7.16.0版本中废弃。本地导出器的值必须始终为local，并且是必需的。
use_ingest
是否向集群提供占位符管道和每个批量请求都有一个管道处理器。默认值为true。如果禁用，则意味着它将不使用管道，这意味着将来的版本不能自动升级批量请求以未来验证。

cluster_alerts.management.enabled
[7.16.0] 已在7.16.0版本中废弃。是否为此集群创建集群警报。默认值为true。要使用此功能，必须启用Watcher。如果您有基本许可证，集群警报将不显示。

wait_master.timeout
[7.16.0] 已在7.16.0版本中废弃。等待主节点为监控设置本地导出器而设置的时间，以时间单位表示。在等待期间，非主节点会警告用户可能缺少配置。默认为30秒。

##### HTTP导出器设置

以下是可以与HTTP导出器一起提供的设置列表。所有设置都显示为您为导出器选择的名称之后的内容：

```yaml
xpack.monitoring.exporters.my_remote:
  type: http
  host: ["host:port", ...]
```

type
[7.16.0] 已在7.16.0版本中弃用。HTTP导出器的值必须始终为http，并且是必需的。

host
[7.16.0] 已在7.16.0版本中弃用。主机支持多种格式，可以是数组形式，也可以是单个值。支持的格式包括主机名、主机名:端口、[http://主机名](http://xn--tiqt5l0ys)、[http://主机名](http://xn--tiqt5l0ys):端口、[https://主机名和https](https://xn--https-jq1hu16ab3av34j)://主机名:端口。主机不能假定。如果未作为主机字符串的一部分提供，默认方案始终为http，如果未提供，则默认端口始终为9200。

```yaml
xpack.monitoring.exporters:
  example1:
    type: http
    host: "10.1.2.3"
  example2:
    type: http
    host: ["http://10.1.2.4"]
  example3:
    type: http
    host: ["10.1.2.5", "10.1.2.6"]
  example4:
    type: http
    host: ["https://10.1.2.3:9200"]
```

auth.username
[7.16.0] 已在7.16.0版本中弃用。如果提供了auth.secure_password，则需要用户名。

auth.secure_password
（安全、可重新加载）[7.16.0] 已在7.16.0版本中弃用。用于auth.username的密码。

connection.timeout
[7.16.0] 已在7.16.0版本中弃用。HTTP连接等待套接字打开请求的时间量，以时间单位表示。默认值为6秒。

connection.read_timeout
[7.16.0] 已在7.16.0版本中弃用。HTTP连接等待套接字返回响应的时间量，以时间单位表示。默认值为10 * connection.timeout（如果未设置任何值，则为60秒）。

ssl
[7.16.0] 已在7.16.0版本中弃用。每个HTTP导出器可以定义自己的TLS/SSL设置或继承它们。请参阅X-Pack监控TLS/SSL设置。

proxy.base_path
[7.16.0] 已在7.16.0版本中弃用。前缀任何传出请求的基本路径，例如/base/path（例如，批量请求将作为/base/path/_bulk发送）。没有默认值。

headers
[7.16.0] 已在7.16.0版本中弃用。可添加到每个请求的可选标头，可帮助通过代理路由请求。

```yaml
xpack.monitoring.exporters.my_remote:
  headers:
    X-My-Array: [abc, def, xyz]
    X-My-Header: abc123
```

基于数组的标头将发送n次，其中n是数组的大小。无法设置Content-Type和Content-Length。监控代理创建的任何标头都将覆盖此处定义的任何内容。

index.name.time_format
[7.16.0] 已在7.16.0版本中弃用。更改每日监控索引的默认日期后缀的机制。默认格式为yyyy.MM.dd。例如，.monitoring-es-7-2021.08.26。

use_ingest
是否向监控集群提供占位符管道和每个批量请求都有一个管道处理器。默认值为true。如果禁用，则意味着它将不使用管道，这意味着将来的版本不能自动升级批量请求以未来验证。

cluster_alerts.management.enabled
[7.16.0] 已在7.16.0版本中弃用。是否为此集群创建集群警报。默认值为true。要使用此功能，必须启用Watcher。如果您有基本许可证，集群警报将不显示。

cluster_alerts.management.blacklist
[7.16.0] 已在7.16.0版本中弃用。阻止特定集群警报的创建。还会删除当前集群中已存在的任何适用的监视。您可以将以下任何监视标识符添加到阻止警报的列表中：

- elasticsearch_cluster_status
- elasticsearch_version_mismatch
- elasticsearch_nodes
- kibana_version_mismatch
- logstash_version_mismatch
- xpack_license_expiration

例如：["elasticsearch_version_mismatch", "xpack_license_expiration"]。

##### X-Pack监控TLS/SSL设置编辑：

您可以配置以下TLS/SSL设置。

```yaml
xpack.monitoring.exporters.$NAME.ssl.supported_protocols
(Static) [7.16.0] 已在7.16.0版本中弃用。支持的协议及其版本。有效的协议有：SSLv2Hello，SSLv3，TLSv1，TLSv1.1，TLSv1.2，TLSv1.3。如果JVM的SSL提供程序支持TLSv1.3，则默认为TLSv1.3，TLSv1.2，TLSv1.1。否则，默认为TLSv1.2，TLSv1.1。

Elasticsearch依赖于您的JDK对SSL和TLS的实现。有关更多信息，请查看JDK版本支持的SSL/TLS版本。

如果xpack.security.fips_mode.enabled为true，则无法使用SSLv2Hello或SSLv3。请参阅FIPS 140-2。

xpack.monitoring.exporters.$NAME.ssl.verification_mode
(Static) [7.16.0] 已在7.16.0版本中弃用。控制证书验证。

有效值：
- full：验证提供的证书是否在not_before和not_after日期范围内具有问题日期；是否链接到受信任的证书颁发机构（CA）；是否具有与证书内的名称匹配的主机名或IP地址。
- certificate：验证提供的证书并验证其是否由受信任的机构（CA）签名，但不检查证书主机名。
- none：不执行证书验证。

将证书验证设置为none会禁用SSL/TLS的许多安全功能，这非常危险。仅在Elastic支持的临时诊断机制中指示时才设置此值，以尝试解决TLS错误。

默认为full。

xpack.monitoring.exporters.$NAME.ssl.cipher_suites
(Static) [7.16.0] 已在7.16.0版本中弃用。支持的密码套件因使用的Java版本而异。例如，对于版本12，默认值为TLS_AES_256_GCM_SHA384，TLS_AES_128_GCM_SHA256，TLS_CHACHA20_POLY1305_SHA256，TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384，TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256，TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384，TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256，TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256，TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256，TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384，TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256，TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384，TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256，TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA，TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA，TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA，TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA，TLS_RSA_WITH_AES_256_GCM_SHA384，TLS_RSA_WITH_AES_128_GCM_SHA256，TLS_RSA_WITH_AES_256_CBC_SHA256，TLS_RSA_WITH_AES_128_CBC_SHA256，TLS_RSA_WITH_AES_256_CBC_SHA，TLS_RSA_WITH_AES_128_CBC_SHA。

有关更多信息，请参阅Oracle的Java密码体系结构文档。

X-Pack监控TLS/SSL密钥和受信任证书设置编辑：

以下设置用于指定在通过SSL/TLS连接进行通信时应使用的私钥、证书和受信任证书。私钥和证书是可选的，如果服务器需要PKI身份验证的客户端身份验证，则会使用它们。

PEM编码文件编辑：
使用PEM编码文件时，请使用以下设置：

```yaml
xpack.monitoring.exporters.$NAME.ssl.key
(Static) [7.16.0] 已在7.16.0版本中弃用。包含私钥的PEM编码文件的路径。

如果需要HTTP客户端身份验证，则会使用此文件。您不能同时使用此设置和ssl.keystore.path。

xpack.monitoring.exporters.$NAME.ssl.key_passphrase
(Static) [7.16.0] 已在7.16.0版本中弃用。用于解密私钥的密码。由于密钥可能未加密，此值是可选的。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.secure_key_passphrase。

您不能同时使用此设置和ssl.secure_key_passphrase。

xpack.monitoring.exporters.$NAME.ssl.secure_key_passphrase
(Secure) [7.16.0] 已在7.16.0版本中弃用。用于解密私钥的密码。由于密钥可能未加密，此值是可选的。
xpack.monitoring.exporters.$NAME.ssl.certificate
(Static) [7.16.0] 已在7.16.0版本中弃用。指定与密钥关联的PEM编码证书（或证书链）的路径。

仅当设置了ssl.key时才能使用此设置。

xpack.monitoring.exporters.$NAME.ssl.certificate_authorities
(Static) [7.16.0] 已在7.16.0版本中弃用。应受信任的PEM编码证书文件的路径列表。

此设置和ssl.truststore.path不能同时使用。

Java密钥库文件编辑：
使用Java密钥库文件（JKS）时，其中包含私钥、证书和应受信任的证书，请使用以下设置：

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.path
(Static) [7.16.0] 已在7.16.0版本中弃用。包含私钥和证书的密钥库文件的路径。

它必须是Java密钥库（jks）或PKCS#12文件。您不能同时使用此设置和ssl.key。

xpack.monitoring.exporters

.$NAME.ssl.keystore.password
(Static) 密钥库的密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.keystore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.secure_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。密钥库的密码。
xpack.monitoring.exporters.$NAME.ssl.keystore.key_password
(Static) 密钥库中密钥的密码。默认值为密钥库密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.keystore.secure_key_password。

您不能同时使用此设置和ssl.keystore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.secure_key_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。密钥库中密钥的密码。默认值为密钥库密码。
xpack.monitoring.exporters.$NAME.ssl.truststore.path
(Static) [7.16.0] 已在7.16.0版本中弃用。包含要信任的证书的密钥库的路径。它必须是Java密钥库（jks）或PKCS#12文件。

您不能同时使用此设置和ssl.certificate_authorities。

```yaml
xpack.monitoring.exporters.$NAME.ssl.truststore.password
(Static) 信任库的密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.truststore.secure_password。

您不能同时使用此设置和ssl.truststore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.truststore.secure_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。信任库的密码。
PKCS#12文件编辑：
Elasticsearch可以配置为使用包含私钥、证书和应受信任的证书的PKCS#12容器文件（.p12或.pfx文件）。

PKCS#12文件的配置方式与Java密钥库文件相同：

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.path
(Static) [7.16.0] 已在7.16.0版本中弃用。包含私钥和证书的密钥库文件的路径。

它必须是Java密钥库（jks）或PKCS#12文件。您不能同时使用此设置和ssl.key。

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.type
(Static) [7.16.0] 已在7.16.0版本中弃用。密钥库文件的格式。它必须是jks或PKCS12。如果密钥库路径以“.p12”、“.pfx”或“.pkcs12”结尾，则此设置默认为PKCS12。否则，默认为jks。
xpack.monitoring.exporters.$NAME.ssl.keystore.password
(Static) [7.16.0] 已在7.16.0版本中弃用。密钥库的密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.keystore.secure_password。

您不能同时使用此设置和ssl.keystore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.secure_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。密钥库的密码。
xpack.monitoring.exporters.$NAME.ssl.keystore.key_password
(Static) 密钥库中密钥的密码。默认值为密钥库密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.keystore.secure_key_password。

您不能同时使用此设置和ssl.keystore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.keystore.secure_key_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。密钥库中密钥的密码。默认值为密钥库密码。
xpack.monitoring.exporters.$NAME.ssl.truststore.path
(Static) [7.16.0] 已在7.16.0版本中弃用。包含要信任的证书的密钥库的路径。它必须是Java密钥库（jks）或PKCS#12文件。

您不能同时使用此设置和ssl.certificate_authorities。

```yaml
xpack.monitoring.exporters.$NAME.ssl.truststore.type
(Static) [7.16.0] 已在7.16.0版本中弃用。将其设置为PKCS12，以指示信任库是PKCS#12文件。
```yaml
xpack.monitoring.exporters.$NAME.ssl.truststore.password
(Static) [7.16.0] 已在7.16.0版本中弃用。信任库的密码。[7.17.0] 已在7.17.0版本中弃用。请改用ssl.truststore.secure_password。

您不能同时使用此设置和ssl.truststore.secure_password。

```yaml
xpack.monitoring.exporters.$NAME.ssl.truststore.secure_password
(Secure) [7.16.0] 已在7.16.0版本中弃用。信任库的密码。
```
